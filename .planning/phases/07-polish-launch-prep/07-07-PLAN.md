---
phase: 07-polish-launch-prep
plan: 07
type: execute
wave: 3
depends_on: ["07-01", "07-04"]
files_modified:
  - src/lib/seed-data.ts
  - src/app/actions/onboarding.ts
  - src/app/(dashboard)/settings/page.tsx
  - src/app/(dashboard)/settings/seed-section.tsx
  - src/components/help-tooltip.tsx
  - src/app/(dashboard)/dispatch/page.tsx
  - src/app/(dashboard)/orders/_components/order-form.tsx
  - src/app/(dashboard)/billing/page.tsx
  - src/app/(dashboard)/settings/team-section.tsx
autonomous: true

must_haves:
  truths:
    - "New trial user can click 'Load Sample Data' and get a realistic demo fleet"
    - "Sample data includes brokers, drivers, trucks, orders, and trips in various statuses"
    - "Help tooltips appear on key workflow pages explaining how to use features"
    - "Sample data can be cleared via 'Clear Sample Data' button"
  artifacts:
    - path: "src/lib/seed-data.ts"
      provides: "Sample data generation functions"
      exports: ["generateSampleData"]
      min_lines: 80
    - path: "src/app/actions/onboarding.ts"
      provides: "seedSampleData and clearSampleData server actions"
      contains: "seedSampleData"
    - path: "src/components/help-tooltip.tsx"
      provides: "Reusable help tooltip component"
      exports: ["HelpTooltip"]
  key_links:
    - from: "src/app/actions/onboarding.ts"
      to: "src/lib/seed-data.ts"
      via: "generateSampleData function call"
      pattern: "generateSampleData"
    - from: "src/components/help-tooltip.tsx"
      to: "src/components/ui/tooltip.tsx"
      via: "shadcn/ui Tooltip wrapper"
      pattern: "import.*Tooltip"
---

<objective>
Build sample data seeding (ONB-3) and in-app help tooltips (ONB-4) to improve the new user experience.

Purpose: New trial users need to see a populated system to understand the product's value. Help tooltips guide them through key workflows without external documentation. These are the final onboarding features for launch.

Output: Sample data generation module, seed/clear server actions, settings section for data management, HelpTooltip component placed on key pages.
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/07-polish-launch-prep/07-RESEARCH.md

# Existing onboarding patterns
@src/app/actions/onboarding.ts
@src/app/(dashboard)/settings/page.tsx

# Entity creation patterns
@src/app/actions/brokers.ts
@src/app/actions/drivers.ts
@src/app/actions/trucks.ts
@src/app/actions/orders.ts
@src/app/actions/trips.ts

# Help tooltip component
@src/components/ui/tooltip.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Sample data generation + seed/clear actions</name>
  <files>
    src/lib/seed-data.ts
    src/app/actions/onboarding.ts
    src/app/(dashboard)/settings/page.tsx
    src/app/(dashboard)/settings/seed-section.tsx
  </files>
  <action>
    Create `src/lib/seed-data.ts`:
    - Export `generateSampleData(tenantId: string)` that returns structured data objects (NOT inserted -- just data):
      ```typescript
      export function generateSampleData(tenantId: string) {
        return {
          brokers: [
            { tenant_id: tenantId, company_name: 'Central Auto Transport', contact_name: 'Mike Johnson', email: 'mike@centralautotrans.com', phone: '555-0101', payment_terms: 'net_30' },
            { tenant_id: tenantId, company_name: 'Pacific Coast Carriers', contact_name: 'Sarah Chen', email: 'sarah@pacificcoast.com', phone: '555-0102', payment_terms: 'cod' },
          ],
          drivers: [
            { tenant_id: tenantId, first_name: 'James', last_name: 'Wilson', email: 'james.wilson@example.com', phone: '555-0201', driver_type: 'company', pay_type: 'percentage', pay_rate: 25, status: 'active' },
            { tenant_id: tenantId, first_name: 'Carlos', last_name: 'Rodriguez', email: 'carlos.r@example.com', phone: '555-0202', driver_type: 'company', pay_type: 'per_car', pay_rate: 75, status: 'active' },
            { tenant_id: tenantId, first_name: 'David', last_name: 'Park', email: 'david.park@example.com', phone: '555-0203', driver_type: 'owner_operator', pay_type: 'percentage', pay_rate: 15, status: 'active' },
          ],
          trucks: [
            { tenant_id: tenantId, unit_number: 'T-101', truck_type: '7_car', year: 2022, make: 'Peterbilt', model: '389', status: 'active' },
            { tenant_id: tenantId, unit_number: 'T-102', truck_type: '9_car', year: 2021, make: 'Kenworth', model: 'W900', status: 'active' },
          ],
          // 8-10 orders across various statuses with realistic vehicle data
          orders: [
            { tenant_id: tenantId, vehicle_year: 2024, vehicle_make: 'Toyota', vehicle_model: 'Camry', vehicle_color: 'white', pickup_city: 'Los Angeles', pickup_state: 'CA', delivery_city: 'Phoenix', delivery_state: 'AZ', revenue: 850, carrier_pay: 700, payment_type: 'cod', status: 'new' },
            { tenant_id: tenantId, vehicle_year: 2023, vehicle_make: 'Honda', vehicle_model: 'Civic', vehicle_color: 'black', pickup_city: 'Houston', pickup_state: 'TX', delivery_city: 'Dallas', delivery_state: 'TX', revenue: 450, carrier_pay: 350, payment_type: 'cop', status: 'new' },
            // ... 6-8 more orders with various makes/models, routes, statuses
            // Include some assigned, picked_up, delivered, and invoiced orders
          ],
        }
      }
      ```
    - Mark seeded records with a `notes` field containing '[SAMPLE DATA]' or use a metadata convention so they can be identified for cleanup
    - Use realistic US city-to-city routes, common vehicle makes, and realistic pricing ($400-$1500 range)

    Update `src/app/actions/onboarding.ts`:
    - Add `seedSampleData` server action:
      1. Verify user is owner role
      2. Call generateSampleData(tenantId)
      3. Insert brokers, then drivers, then trucks, then orders in dependency order
      4. Optionally create 1-2 trips from the seeded data:
         - Trip 1: Completed trip with 3 delivered orders (shows earnings)
         - Trip 2: In-progress trip with 2 assigned orders (shows active dispatch)
      5. For completed trip: set financial fields using recalculateTripFinancials
      6. Return { success: true, counts: { brokers: 2, drivers: 3, trucks: 2, orders: N, trips: 2 } }

    - Add `clearSampleData` server action:
      1. Verify user is owner role
      2. Delete records with '[SAMPLE DATA]' in notes field (or use the identification convention)
      3. Delete in reverse dependency order: trips (and cascade), orders, trucks, drivers, brokers
      4. revalidatePath('/') to refresh all pages

    Create `src/app/(dashboard)/settings/seed-section.tsx`:
    - 'use client' component
    - Card with title "Sample Data"
    - Description: "Load sample data to explore VroomX features with realistic demo content."
    - "Load Sample Data" button (calls seedSampleData)
    - "Clear Sample Data" button (calls clearSampleData, with ConfirmDialog)
    - Loading state during seed/clear
    - Success/error toast notifications
    - Only visible for owner role

    Update settings page to include SeedSection component.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - generateSampleData returns structured data with brokers, drivers, trucks, orders
    - seedSampleData and clearSampleData actions exported from onboarding.ts
    - Settings page shows seed section for owner users
  </verify>
  <done>
    Sample data generation with realistic fleet data (2 brokers, 3 drivers, 2 trucks, 8-10 orders, 2 trips). Seed and clear server actions. Settings page section for data management. Owner-only access.
  </done>
</task>

<task type="auto">
  <name>Task 2: Help tooltip component + placement on key pages</name>
  <files>
    src/components/help-tooltip.tsx
    src/app/(dashboard)/dispatch/page.tsx
    src/app/(dashboard)/orders/_components/order-form.tsx
    src/app/(dashboard)/billing/page.tsx
    src/app/(dashboard)/settings/team-section.tsx
  </files>
  <action>
    Create `src/components/help-tooltip.tsx`:
    - Reusable component wrapping shadcn/ui Tooltip with a HelpCircle icon trigger
    ```tsx
    'use client'
    import { HelpCircle } from 'lucide-react'
    import {
      Tooltip,
      TooltipContent,
      TooltipProvider,
      TooltipTrigger,
    } from '@/components/ui/tooltip'

    interface HelpTooltipProps {
      content: string
      side?: 'top' | 'right' | 'bottom' | 'left'
      className?: string
    }

    export function HelpTooltip({ content, side = 'top', className }: HelpTooltipProps) {
      return (
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <HelpCircle className={cn('h-4 w-4 text-muted-foreground cursor-help inline-block ml-1', className)} />
            </TooltipTrigger>
            <TooltipContent side={side} className="max-w-xs">
              <p className="text-sm">{content}</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>
      )
    }
    ```
    - Import `cn` from '@/lib/utils'

    Place tooltips on key pages (add HelpTooltip next to relevant headings/labels):

    **Dispatch page** (`src/app/(dashboard)/dispatch/page.tsx`):
    - Next to page title: "Create trips to group orders for a driver and truck. Track trip status from Planned through Completed."
    - Next to capacity indicator (if visible): "Capacity is based on truck type. Exceeding capacity shows a warning but won't block assignment."

    **Order form** (`src/app/(dashboard)/orders/_components/order-form.tsx`):
    - Next to "Revenue" field: "Total amount the broker pays for transporting this vehicle."
    - Next to "Carrier Pay" field: "Amount your company receives. This is used to calculate driver pay."
    - Next to "Payment Type" field: "COD = Cash on Delivery, COP = Cash on Pickup, BILL = Invoice after delivery."

    **Billing page** (`src/app/(dashboard)/billing/page.tsx`):
    - Next to "Aging Analysis" heading: "Shows how long invoices have been outstanding. Older invoices may need follow-up."
    - Next to "Collection Rate" metric: "Percentage of invoiced revenue that has been collected."

    **Settings team section** (`src/app/(dashboard)/settings/team-section.tsx`):
    - Next to "Invite" heading: "Team members will receive an email invitation. They can join with the role you assign."

    Keep tooltip content concise (1-2 sentences max). Tone: helpful, not condescending.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - HelpTooltip component renders HelpCircle icon with tooltip on hover
    - Tooltips visible on dispatch, order form, billing, and settings pages
  </verify>
  <done>
    HelpTooltip reusable component created. Help tooltips placed on 4 key pages: dispatch (trip workflow), order form (financial fields), billing (aging/collection), settings (team invites). Concise, contextual help for new users.
  </done>
</task>

</tasks>

<verification>
- Sample data loads successfully with realistic content
- Sample data can be cleared without affecting real data
- HelpTooltip renders correctly with HelpCircle trigger
- Tooltips appear on dispatch, order form, billing, and settings pages
- `npx tsc --noEmit` passes
</verification>

<success_criteria>
New trial users can: (1) load sample data to explore all features with realistic demo content, (2) see contextual help tooltips on key workflow pages, (3) clear sample data when ready to use real data.
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish-launch-prep/07-07-SUMMARY.md`
</output>
