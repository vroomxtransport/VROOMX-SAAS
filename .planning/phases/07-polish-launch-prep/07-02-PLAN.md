---
phase: 07-polish-launch-prep
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/not-found.tsx
  - src/app/error.tsx
  - src/app/(dashboard)/error.tsx
  - src/app/(dashboard)/loading.tsx
  - src/app/(dashboard)/not-found.tsx
  - src/app/(auth)/error.tsx
  - src/app/(auth)/loading.tsx
autonomous: true

must_haves:
  truths:
    - "Unknown URLs show a styled 404 page with navigation back to dashboard"
    - "Unhandled rendering errors in dashboard routes show error page with retry button"
    - "Dashboard routes show a skeleton loading state during page transitions"
    - "Auth routes show a centered loading spinner during page transitions"
    - "Errors are reported to Sentry automatically"
  artifacts:
    - path: "src/app/not-found.tsx"
      provides: "Global 404 page"
      min_lines: 20
    - path: "src/app/error.tsx"
      provides: "Root error boundary"
      min_lines: 20
    - path: "src/app/(dashboard)/error.tsx"
      provides: "Dashboard error boundary"
      min_lines: 25
    - path: "src/app/(dashboard)/loading.tsx"
      provides: "Dashboard loading skeleton"
      min_lines: 15
    - path: "src/app/(dashboard)/not-found.tsx"
      provides: "Dashboard 404 page"
      min_lines: 15
    - path: "src/app/(auth)/error.tsx"
      provides: "Auth error boundary"
      min_lines: 20
    - path: "src/app/(auth)/loading.tsx"
      provides: "Auth loading state"
      min_lines: 10
  key_links:
    - from: "src/app/(dashboard)/error.tsx"
      to: "@sentry/nextjs"
      via: "Sentry.captureException in useEffect"
      pattern: "Sentry\\.captureException"
    - from: "src/app/(dashboard)/loading.tsx"
      to: "src/components/ui/skeleton.tsx"
      via: "Skeleton component import"
      pattern: "import.*Skeleton"
---

<objective>
Add error boundaries, loading states, and 404 pages across all route groups using Next.js App Router file conventions. global-error.tsx already exists (from Phase 1 Sentry setup).

Purpose: Every production app needs graceful error handling and loading states. Users should never see a blank white screen or an unhandled React error stack trace. Sentry should capture all errors for debugging.

Output: 7 new files covering error/loading/404 for root, dashboard, and auth route groups.
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md

# Existing error handling
@src/app/global-error.tsx
@src/app/layout.tsx
@src/app/(dashboard)/layout.tsx
@src/components/ui/skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Root-level not-found and error pages</name>
  <files>
    src/app/not-found.tsx
    src/app/error.tsx
  </files>
  <action>
    Create `src/app/not-found.tsx`:
    - 'use client' is NOT needed (not-found.tsx can be a Server Component)
    - Centered layout with a large "404" heading
    - "Page not found" subheading with muted text
    - "The page you're looking for doesn't exist or has been moved."
    - Link button back to "/" using Next.js Link component
    - Import `Link` from 'next/link' and `Button` from '@/components/ui/button'
    - Use Tailwind: flex min-h-screen items-center justify-center, text-center

    Create `src/app/error.tsx`:
    - Must be 'use client' (required by Next.js)
    - Receives `{ error, reset }` props with types `Error & { digest?: string }` and `() => void`
    - useEffect to call `Sentry.captureException(error)` (import from '@sentry/nextjs')
    - Centered layout with AlertTriangle icon (from lucide-react)
    - "Something went wrong" heading
    - "An unexpected error occurred. Please try again." subtext
    - Button calling reset() for retry
    - Link button to "/" as fallback
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Both files exist and export default components
  </verify>
  <done>
    Root 404 page shows friendly message with home link. Root error boundary catches rendering errors, reports to Sentry, and offers retry + home navigation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Dashboard and auth route group error/loading pages</name>
  <files>
    src/app/(dashboard)/error.tsx
    src/app/(dashboard)/loading.tsx
    src/app/(dashboard)/not-found.tsx
    src/app/(auth)/error.tsx
    src/app/(auth)/loading.tsx
  </files>
  <action>
    Create `src/app/(dashboard)/error.tsx`:
    - 'use client' component
    - useEffect with Sentry.captureException(error)
    - Styled within the dashboard layout context (no min-h-screen, use min-h-[400px] instead since sidebar is present)
    - AlertTriangle icon, "Something went wrong" heading
    - Error digest shown in small muted text (if available): `Error ID: {error.digest}`
    - Button with reset() for retry
    - Link to /dashboard as fallback navigation

    Create `src/app/(dashboard)/loading.tsx`:
    - Server Component (no 'use client' needed)
    - Import Skeleton from '@/components/ui/skeleton'
    - Render a dashboard page skeleton: header bar skeleton (h-8 w-48), then a grid of 4 card skeletons (h-32) in a 2x2 grid on lg, 1 col on mobile, then a large content area skeleton (h-64)
    - Use consistent spacing: space-y-6 for sections, gap-4 for grid

    Create `src/app/(dashboard)/not-found.tsx`:
    - Server Component
    - "Page not found" message within dashboard layout context
    - Link back to /dashboard
    - Minimal: centered in min-h-[400px]

    Create `src/app/(auth)/error.tsx`:
    - 'use client' component
    - Similar to root error.tsx but centered in auth layout context (min-h-screen)
    - Sentry.captureException
    - Reset button + link to /login

    Create `src/app/(auth)/loading.tsx`:
    - Server Component
    - Simple centered spinner/skeleton: a card skeleton with form field skeletons inside
    - Match auth page dimensions roughly (max-w-md mx-auto)
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - All 5 files exist at correct paths
    - Dashboard loading.tsx imports Skeleton component
    - Error files import Sentry
  </verify>
  <done>
    Dashboard routes: error boundary with Sentry + retry, loading skeleton with card grid, 404 with dashboard link. Auth routes: error boundary with Sentry, loading skeleton with form placeholder. All route groups have graceful error/loading handling.
  </done>
</task>

</tasks>

<verification>
- 7 new files created across root, dashboard, and auth route groups
- `npx tsc --noEmit` passes
- Error files use 'use client' and call Sentry.captureException
- Loading files use Skeleton component from shadcn/ui
- Not-found files provide navigation back to appropriate landing pages
- global-error.tsx (existing from Phase 1) left untouched
</verification>

<success_criteria>
Any unknown URL shows a 404 page. Any rendering crash in dashboard or auth routes shows an error page with retry, and the error is sent to Sentry. Page transitions in dashboard show skeleton loading states.
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish-launch-prep/07-02-SUMMARY.md`
</output>
