---
phase: 06-ios-driver-app
plan: 05
type: execute
wave: 3
depends_on: ["06-03", "06-04"]
files_modified:
  - VroomXDriver/Views/Home/HomeView.swift
  - VroomXDriver/Views/Home/OrderCardView.swift
  - VroomXDriver/Views/Home/ModuleTabsView.swift
  - VroomXDriver/Views/Main/MainTabView.swift
autonomous: true

must_haves:
  truths:
    - "Home screen shows greeting with driver name and date"
    - "Quick stats cards show order counts (pickup, delivery, completed, total)"
    - "Module tabs filter orders by status category (Pickup, Delivery, Completed, Archived)"
    - "Order cards display vehicle info, addresses, status badge, and quick actions"
    - "Tapping an order card navigates to order detail"
  artifacts:
    - path: "VroomXDriver/Views/Home/HomeView.swift"
      provides: "Home tab content with greeting, stats, module tabs, order list"
      contains: "HomeView"
    - path: "VroomXDriver/Views/Home/OrderCardView.swift"
      provides: "Reusable order card component"
      contains: "OrderCardView"
    - path: "VroomXDriver/Views/Home/ModuleTabsView.swift"
      provides: "Pickup/Delivery/Completed/Archived segmented filter"
      contains: "ModuleTabsView"
  key_links:
    - from: "VroomXDriver/Views/Home/HomeView.swift"
      to: "VroomXDriver/Core/DataManager.swift"
      via: "Observes orders from DataManager"
      pattern: "DataManager\\.shared"
    - from: "VroomXDriver/Views/Home/OrderCardView.swift"
      to: "VroomXDriver/Models/Order.swift"
      via: "Takes VroomXOrder as input"
      pattern: "VroomXOrder"
---

<objective>
Build the Home tab with greeting, quick stats, module tabs (Pickup/Delivery/Completed/Archived), and order card list.

Purpose: The Home tab is the driver's primary landing screen after login. It shows at-a-glance stats and organizes orders by status category with quick actions.

Output: HomeView, OrderCardView, ModuleTabsView replacing the Home tab placeholder in MainTabView
</objective>

<execution_context>
@/Users/reepsy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/reepsy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/06-ios-driver-app/06-CONTEXT.md
@.planning/phases/06-ios-driver-app/06-03-SUMMARY.md
@.planning/phases/06-ios-driver-app/06-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build HomeView with greeting, stats, and module tabs</name>
  <files>
    VroomXDriver/Views/Home/HomeView.swift
    VroomXDriver/Views/Home/ModuleTabsView.swift
  </files>
  <action>
**HomeView.swift:**
- NavigationStack wrapper for navigation to order detail
- **Header section:**
  - Greeting: "Good morning/afternoon/evening, {driver.first_name}" with dynamic time-of-day
  - Date: formatted current date (e.g., "Wednesday, February 12")
  - OfflineBanner overlay when disconnected
- **Quick stats row:** 4 stat cards in horizontal scroll:
  - Pickup: count of orders with status in [new, assigned] — amber color
  - Delivery: count of orders with status == picked_up — blue color
  - Completed: count of orders with status == delivered — green color
  - Total: total order count — brandPrimary color
  - Each card: icon (SF Symbol), count number (large mono font), label
- **Module tabs:** ModuleTabsView for filtering
- **Order list:** Filtered orders displayed as OrderCardView in a LazyVStack within ScrollView
- Empty state when no orders: "No orders in this category" with truck icon
- Pull-to-refresh to reload data from DataManager
- `@ObservedObject var dataManager = DataManager.shared`
- `@EnvironmentObject var authManager: AuthManager` for driver name

**ModuleTabsView.swift:**
- Segmented picker or custom tab bar with 4 options:
  1. **Pickup** — orders with status in [new, assigned] (orders awaiting pickup)
  2. **Delivery** — orders with status == picked_up (in transit, awaiting delivery)
  3. **Completed** — orders with status == delivered (successfully delivered)
  4. **Archived** — orders with status in [invoiced, paid, cancelled]
- `@Binding var selectedModule: OrderModule`
- Visual: pill-shaped selection indicator with brandPrimary background on selected tab
- Count badges on each tab showing number of orders in that category
  </action>
  <verify>HomeView shows greeting, 4 stat cards, module tabs with correct order filtering. Orders display in LazyVStack.</verify>
  <done>Home tab shows personalized greeting, order stats, and filterable order list by status category</done>
</task>

<task type="auto">
  <name>Task 2: Build OrderCardView and wire Home tab into MainTabView</name>
  <files>
    VroomXDriver/Views/Home/OrderCardView.swift
    VroomXDriver/Views/Main/MainTabView.swift
  </files>
  <action>
**OrderCardView.swift:**
- Takes `order: VroomXOrder` as input
- Card layout on cardBackground with rounded corners and subtle border:
  - **Top row:** Vehicle description (year make model) in bold, status badge (colored pill)
  - **Vehicle info:** Color dot + vehicle color name, VIN (last 8 chars)
  - **Pickup section:** mappin icon + pickup city/state, calendar icon + pickup date
  - **Delivery section:** mappin icon + delivery city/state, calendar icon + delivery date
  - **Contact info:** If pickup_contact_name present, show name + phone with tap-to-call action
  - **Bottom row:** Order number label (left), quick action buttons (right):
    - If status is new/assigned: "Start Pickup" button (brandPrimary)
    - If status is picked_up: "Mark Delivered" button (brandSuccess)
    - If delivered: "View Details" button (outline)
- Status badge colors:
  - new: gray, assigned: amber, picked_up: blue, delivered: green, invoiced: violet, paid: green, cancelled: red
- NavigationLink wrapping the card for tap-to-detail navigation
- Compact but informative design matching Horizon v3 order cards

**Update MainTabView.swift:**
- Replace Home tab placeholder `Text("Home")` with `HomeView()`
- Ensure HomeView receives DataManager and AuthManager from environment
  </action>
  <verify>OrderCardView displays vehicle, addresses, dates, status badge, and quick actions. MainTabView Home tab shows real HomeView.</verify>
  <done>Order cards provide at-a-glance vehicle and route info with status-aware quick actions; Home tab is fully wired</done>
</task>

</tasks>

<verification>
- Home tab shows real driver name in greeting
- Quick stats counts match actual order data
- Module tabs correctly filter: Pickup=[new,assigned], Delivery=[picked_up], Completed=[delivered], Archived=[invoiced,paid,cancelled]
- Order cards show vehicle, pickup/delivery locations, dates, and status
- Pull-to-refresh reloads data
- NavigationLink on order card navigates (target view built in Plan 07)
</verification>

<success_criteria>
- Driver sees personalized home screen with order stats and filtered order list
- Module tabs switch between order categories correctly
- Order cards are visually clear and tappable
</success_criteria>

<output>
After completion, create `.planning/phases/06-ios-driver-app/06-05-SUMMARY.md`
</output>
